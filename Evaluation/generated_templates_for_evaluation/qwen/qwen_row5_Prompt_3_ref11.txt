tosca_definitions_version: tosca_simple_yaml_1_0

description: Deployment environment for Alien4Cloud with specific configurations and components.

topology_template:
  node_templates:
    alien4cloud_node:
      type: tosca.nodes.SoftwareComponent
      properties:
        context_root: /
        profiles:
          - security-demo
          - noApiDoc
      relationships:
        - type: tosca.relationships.HostedOn
          target: jdk_node
        - type: tosca.relationships.ConnectsTo
          target: elasticsearch_node_1
        - type: tosca.relationships.ConnectsTo
          target: elasticsearch_node_2
        - type: tosca.relationships.ConnectsTo
          target: it_testing_node

    elasticsearch_node_1:
      type: tosca.nodes.Database
      properties:
        instance_number: 1
        replication_type: remote

    elasticsearch_node_2:
      type: tosca.nodes.Database
      properties:
        instance_number: 2
        replication_type: remote

    jdk_node:
      type: tosca.nodes.SoftwareComponent
      properties:
        jdk_type: oracle
        version: 11
        download_url: https://www.oracle.com/java/technologies/javase-jdk11-downloads.html
        install_path: /usr/lib/jvm/oracle-jdk11

    it_testing_node:
      type: tosca.nodes.TestSuite
      properties:
        branch: develop
        version: 1.3.0-RC5
        test_suite_name: RunCloudify3AmazonLongRunIT

    compute_node_1:
      type: tosca.nodes.Compute
      properties:
        ip_address: 192.168.1.10
      relationships:
        - type: tosca.relationships.Hosts
          target: alien4cloud_node
        - type: tosca.relationships.Hosts
          target: jdk_node

    compute_node_2:
      type: tosca.nodes.Compute
      properties:
        ip_address: 192.168.1.20
      relationships:
        - type: tosca.relationships.Hosts
          target: elasticsearch_node_1

    compute_node_3:
      type: tosca.nodes.Compute
      properties:
        ip_address: 192.168.1.21
      relationships:
        - type: tosca.relationships.Hosts
          target: elasticsearch_node_2

    network_node:
      type: tosca.nodes.Network
      properties:
        network_type: IPv4
      relationships:
        - type: tosca.relationships.ConnectsTo
          target: compute_node_1
        - type: tosca.relationships.ConnectsTo
          target: compute_node_2
        - type: tosca.relationships.ConnectsTo
          target: compute_node_3
