tosca_definitions_version: alien_dsl_2_0_0

metadata:
  description: Setup for hosting a web server within a private network.

description: >
  A template to deploy a secure web server accessible only within a private network,
  with capabilities to start, stop, and restart the server. It also includes a check
  for the welcome page functionality.

imports:
  - http://alien4cloud.github.io/alien-distribution/2.3.3/types.yaml

topology_template:

  node_templates:

    web_server:
      type: org.alien4cloud.nodes.Compute
      properties:
        image: ubuntu:latest


    security_group:
      type: org.alien4cloud.nodes.SecurityGroup
      properties:
        rules:
          - protocol: tcp
            start_port: 80

    web_server_configuration:
      type: org.alien4cloud.nodes.Configuration
      requirements:
        - host: [ web_server ]

    welcome_page_check:
      type: org.alien4cloud.nodes.ServiceCheck
      properties:
        initial_delay: 30s
        period: 60s
        timeout: 10s

      requirements:
        - host: [ web_server ]

  policies:

    start_stop_restart_policy:
      type: org.alien4cloud.policies.NodeStartStopRestartPolicy
      targets: [ web_server ]
