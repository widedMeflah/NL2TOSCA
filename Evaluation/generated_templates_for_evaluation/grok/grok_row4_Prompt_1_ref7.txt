tosca_definitions_version: alien_dsl_2_0_0

metadata:
  template_name: DataStorageSystem
  template_version: 1.0.0
  template_author: user

imports:
  - tosca-normative-types:1.0.0-ALIEN20

topology_template:
  node_templates:
    ComputeServer:
      type: tosca.nodes.Compute
      capabilities:
        host:
          properties:
            num_cpus: 2
            mem_size: 4 GB
            disk_size: 50 GB
        os:
          properties:
            architecture: x86_64
            type: linux
            distribution: ubuntu
      requirements:
        - network: PrivateNetwork

    PrivateNetwork:
      type: tosca.nodes.Network
      properties:
        ip_version: 4
        cidr: 192.168.1.0/24
        gateway_ip: 192.168.1.1
        network_type: private

    MongoDB:
      type: tosca.nodes.Database
      properties:
        port: 27017
      capabilities:
        database_endpoint:
          properties:
            protocol: tcp
            port: 27017
      requirements:
        - host: ComputeServer
        - network: PrivateNetwork

  outputs:
    server_ip:
      value: { get_attribute: [ComputeServer, ip_address] }
    database_port:
      value: { get_attribute: [MongoDB, database_endpoint, port] }