
topology_template:
  name: mongodb_on_linux
  description: Topology template for MongoDB service on a Linux-based compute instance
  version: 1.0.0

  node_types:
    MongoDB:
      class: csar
      ocf: octopus.action.server.deploy.MongoDB
      metaproperties:
        x-orchestration-category: database
      properties:
        data_directory: /data/db
        bind_ip:
          description: IP address of the MongoDB instance
          default: 0.0.0.0
          pattern: ^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$
        port:
          description: Port on which MongoDB instance is accessible
          default: 27017
          pattern: ^[1-9][0-9]{0,4}$

  relationships:
    - type: std:host
      target_ref: MongoDB

  outputs:
    mongodb_port:
      description: Port on which MongoDB instance is accessible
      value: ${MongoDB.properties.port}
    mongodb_ip:
      description: IP address of the MongoDB host machine
      value: ${MongoDB.properties.bind_ip}
