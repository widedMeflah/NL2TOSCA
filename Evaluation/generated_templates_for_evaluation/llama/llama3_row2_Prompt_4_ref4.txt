
tosca_definitions_version: tosca_simple_yaml_1_0

topology_template:
  description: Apache Server Deployment Topology
  node_templates:
    Compute:
      type: tosca.nodes.Compute
      capabilities:
        endpoint:
          properties:
            network_name: my_network
            ports:
              - 80

    Apache:
      type: tosca.nodes.WebServer
      properties:
        protocol: http
      requirements:
        - host: Compute
      interfaces:
        Standard:
          start:
            implementation: start_apache.sh
          stop:
            implementation: stop_apache.sh
          restart:
            implementation: restart_apache.sh

  workflow_templates:
    Start_Apache:
      description: Start Apache server
      workflow_definition:
        type: tosca.libraries.WorkflowDefinition
        steps:
          - start_apache:
              activity: Apache.Standard.start

    Stop_Apache:
      description: Stop Apache server
      workflow_definition:
        type: tosca.libraries.WorkflowDefinition
        steps:
          - stop_apache:
              activity: Apache.Standard.stop

    Restart_Apache:
      description: Restart Apache server
      workflow_definition:
        type: tosca.libraries.WorkflowDefinition
        steps:
          - restart_apache:
              activity: Apache.Standard.restart

    Access_Welcome_Page:
      description: Access Apache server's welcome page
      workflow_definition:
        type: tosca.libraries.WorkflowDefinition
        steps:
          - access_welcome_page:
              activity: tosca.libraries.CurlActivity
              inputs:
                url: http://Compute:80
