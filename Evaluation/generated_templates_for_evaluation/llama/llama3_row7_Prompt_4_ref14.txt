
tosca_definitions_version: tosca_simple_yaml_1_0

description: Web Application Deployment Configuration

topology_template:
  node_templates:
    Compute:
      type: tosca.nodes.Compute
      properties:
        num_cpus: 1
        disk_size: 10 GB
        mem_size: 4 GB
      capabilities:
        endpoint:
          properties:
            protocol: http
            ports:
              - 8080
        os:
          properties:
            type: linux
            architecture: x86_64
            distribution: ubuntu

    Java:
      type: tosca.nodes.Java
      properties:
        java_version: java

    Tomcat:
      type: tosca.nodes.WebServer
      properties:
        port: 8080
        protocol: http
      requirements:
        - host: Compute
        - dependency: Java

    WebApplication:
      type: tosca.nodes.WebApplication
      properties:
        content: war_file
        context_root: /
      requirements:
        - host: Tomcat
        - dependency: Java

  relationship_templates:
    - type: tosca.relationships.DependsOn
      properties:
        dependency: Tomcat

  output_templates:
    server_url:
      value: { get_attribute: [ Tomcat, endpoint, url ] }
    application_url:
      value: { get_attribute: [ WebApplication, endpoint, url ] }