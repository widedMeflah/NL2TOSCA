tosca_definitions_version: tosca_simple_yaml_1_0

topology_template:
  node_templates:
    PlantClassificationApp:
      type: tosca.nodes.Container.Application
      properties:
        appl_name: Plant Classification App
        appl_version: 1.0
        port: 8080
        cpu: 2
        memory: 4096
      capabilities:
        scalable:
          properties:
            min_instances: 1
            max_instances: 5
        bindable:
          properties:
            port: 8080
      requirements:
        - container:
            node: Container
            relationship: tosca.relationships.Container
        - network:
            node: Network
            relationship: tosca.relationships.Network

    Container:
      type: tosca.nodes.Container.Runtime
      properties:
        image: plant-classification-app:latest
        network: all
        port: 8080
      capabilities:
        container:
          properties:
            cpu: 2
            memory: 4096

    Network:
      type: tosca.nodes.Network
      properties:
        network_name: plant-classification-net
      capabilities:
        network:
          properties:
            ip_address: 0.0.0.0
            port: 8080
        bindable:
          properties:
            port: 8080

    LoadBalancer:
      type: tosca.nodes.LoadBalancer
      properties:
        algorithm: round-robin
        port: 8080
      requirements:
        - network:
            node: Network
            relationship: tosca.relationships.Network
        - server:
            node: PlantClassificationApp
            relationship: tosca.relationships.Server