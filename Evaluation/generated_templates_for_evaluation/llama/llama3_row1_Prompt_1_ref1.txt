
tosca_definitions_version: tosca_simple_yaml_1_0

topology_template:
  node_templates:
    Java_App:
      type: tosca.nodes.Compute
      properties:
        num_cpus: 1
        mem_size: 512 MB
      capabilities:
        endpoint:
          properties:
            network_name: public
            ports:
              app_port: 8080
        operating_system:
          properties:
            type: linux
        scalable:
          properties:
            min_instances: 1
            max_instances: 1
      artifacts:
        java_runtime:
          type: tosca.artifacts.Implementation.Java
          file: java-8-jdk
          repository: alien4cloud
      relationships:
        - type: tosca.relationships.ConnectsTo
          target: Search_Engine
          properties:
            protocol: tcp
            port: 8081
        - type: tosca.relationships.HostedOn
          target: Java_Environment
    Search_Engine:
      type: tosca.nodes.Compute
      properties:
        num_cpus: 1
        mem_size: 512 MB
      capabilities:
        endpoint:
          properties:
            network_name: public
            ports:
              search_port: 8081
        operating_system:
          properties:
            type: linux
        scalable:
          properties:
            min_instances: 1
            max_instances: 1
      artifacts:
        search_engine:
          type: tosca.artifacts.Implementation.SearchEngine
          file: elasticsearch-7.10.2
          repository: alien4cloud
        java_runtime:
          type: tosca.artifacts.Implementation.Java
          file: java-8-jdk
          repository: alien4cloud
      relationships:
        - type: tosca.relationships.HostedOn
          target: Search_Environment
    Java_Environment:
      type: tosca.nodes.Environment
      properties:
        env_name: java_env
    Search_Environment:
      type: tosca.nodes.Environment
      properties:
        env_name: search_env
